# AWS EC2 인스턴스 타입 선택 가이드

Playwright 브라우저 자동화를 위한 AWS EC2 인스턴스 추천 사양입니다.

## 리소스 요구사항

### Playwright/Chromium 특징

-   **메모리**: 브라우저 인스턴스당 약 **200-500MB** 사용
-   **CPU**: 페이지 렌더링 및 JavaScript 실행에 **높은 CPU 사용량**
-   **디스크**: 브라우저 캐시 및 임시 파일 저장 (최소 10GB 권장)
-   **네트워크**: 페이지 로딩 및 리소스 다운로드

### 동시 실행 고려사항

-   동시에 실행되는 브라우저 인스턴스 수
-   각 인스턴스는 메모리와 CPU를 많이 사용
-   메모리 부족 시 OOM(Out of Memory) 에러 발생 가능

## 인스턴스 타입 추천

### 1. **소규모/개발/테스트용** (동시 1-2개 브라우저)

#### t3.medium (권장)

-   **vCPU**: 2
-   **메모리**: 4GB
-   **네트워크**: Up to 5 Gbps
-   **가격**: ~$0.0416/hour (약 $30/월)
-   **특징**:
    -   버스터블 성능 (최대 40% CPU 크레딧)
    -   개발/테스트 환경에 적합
    -   단일 브라우저 실행 시 충분

#### t3.large

-   **vCPU**: 2
-   **메모리**: 8GB
-   **네트워크**: Up to 5 Gbps
-   **가격**: ~$0.0832/hour (약 $60/월)
-   **특징**:
    -   동시 2-3개 브라우저 실행 가능
    -   메모리 여유가 있음

### 2. **중규모/프로덕션용** (동시 3-5개 브라우저)

#### t3.xlarge (권장)

-   **vCPU**: 4
-   **메모리**: 16GB
-   **네트워크**: Up to 5 Gbps
-   **가격**: ~$0.1664/hour (약 $120/월)
-   **특징**:
    -   동시 3-5개 브라우저 실행 가능
    -   프로덕션 환경에 적합
    -   비용 대비 성능 우수

#### m5.xlarge

-   **vCPU**: 4
-   **메모리**: 16GB
-   **네트워크**: Up to 10 Gbps
-   **가격**: ~$0.192/hour (약 $140/월)
-   **특징**:
    -   일관된 성능 (버스터블 아님)
    -   안정적인 워크로드에 적합

### 3. **대규모/고성능** (동시 5개 이상 브라우저)

#### t3.2xlarge

-   **vCPU**: 8
-   **메모리**: 32GB
-   **네트워크**: Up to 5 Gbps
-   **가격**: ~$0.3328/hour (약 $240/월)
-   **특징**:
    -   동시 5-10개 브라우저 실행 가능
    -   높은 동시 처리 능력

#### m5.2xlarge

-   **vCPU**: 8
-   **메모리**: 32GB
-   **네트워크**: Up to 10 Gbps
-   **가격**: ~$0.384/hour (약 $280/월)
-   **특징**:
    -   일관된 성능
    -   프로덕션 고부하 환경에 적합

## 인스턴스 타입 비교

### t3 시리즈 (버스터블)

**장점:**

-   저렴한 비용
-   기본 워크로드에 충분
-   CPU 크레딧으로 일시적 부하 처리 가능

**단점:**

-   CPU 크레딧 고갈 시 성능 제한
-   지속적인 고부하에는 부적합

**적용 케이스:**

-   개발/테스트 환경
-   간헐적인 크롤링 작업
-   트래픽이 불규칙한 경우

### m5 시리즈 (일관된 성능)

**장점:**

-   일관된 CPU 성능
-   안정적인 워크로드 처리
-   높은 네트워크 대역폭

**단점:**

-   t3 대비 비용이 높음
-   간헐적 워크로드에는 비효율적

**적용 케이스:**

-   프로덕션 환경
-   지속적인 고부하
-   안정적인 성능이 중요한 경우

## 메모리 계산 가이드

### 메모리 요구사항 계산

```
필요한 메모리 =
  운영체제 (1-2GB) +
  Node.js 앱 (500MB-1GB) +
  (브라우저 인스턴스 수 × 400MB) +
  여유 공간 (1-2GB)
```

**예시:**

-   동시 3개 브라우저 실행 시:

    -   2GB (OS) + 1GB (Node.js) + (3 × 400MB) + 1GB = **5.2GB**
    -   **→ 최소 8GB 권장 (t3.large 이상)**

-   동시 5개 브라우저 실행 시:
    -   2GB (OS) + 1GB (Node.js) + (5 × 400MB) + 1GB = **6GB**
    -   **→ 최소 16GB 권장 (t3.xlarge 이상)**

## 스토리지 추천

### EBS 볼륨 타입

-   **gp3 (권장)**: 범용 SSD, 3,000 IOPS 기본
-   **gp2**: 범용 SSD, 3,000 IOPS 기본 (구형)
-   **최소 크기**: 20GB (브라우저 캐시 및 로그 저장용)

### 디스크 크기

-   **최소**: 20GB
-   **권장**: 30-50GB (여유 공간 확보)
-   **대용량**: 100GB 이상 (로그 파일 누적 대비)

## 네트워크 고려사항

### 네트워크 대역폭

-   페이지 로딩 시 많은 리소스 다운로드
-   동시 브라우저 수에 따라 네트워크 사용량 증가
-   **최소**: Up to 5 Gbps (t3 시리즈)
-   **권장**: Up to 10 Gbps (m5 시리즈)

## 비용 최적화 팁

### 1. 스팟 인스턴스 활용

-   **최대 90% 할인** 가능
-   단기 작업에 적합
-   **주의**: 언제든지 중단될 수 있음

### 2. 예약 인스턴스

-   1년 또는 3년 약정 시 **최대 75% 할인**
-   장기 운영 시 유리

### 3. 자동 스케일링

-   AWS Auto Scaling으로 트래픽에 따라 인스턴스 수 조절
-   비용 절감 및 성능 유지

### 4. 스케줄링

-   작업이 정기적인 경우 스케줄링으로 인스턴스 시작/종료
-   사용하지 않는 시간에는 비용 절감

## 추천 구성

### 개발/테스트 환경

```
인스턴스 타입: t3.medium
vCPU: 2
메모리: 4GB
스토리지: 30GB gp3
예상 비용: ~$30/월
```

### 소규모 프로덕션

```
인스턴스 타입: t3.large
vCPU: 2
메모리: 8GB
스토리지: 50GB gp3
예상 비용: ~$60/월
```

### 중규모 프로덕션 (권장)

```
인스턴스 타입: t3.xlarge
vCPU: 4
메모리: 16GB
스토리지: 50GB gp3
예상 비용: ~$120/월
```

### 대규모 프로덕션

```
인스턴스 타입: m5.2xlarge
vCPU: 8
메모리: 32GB
스토리지: 100GB gp3
예상 비용: ~$280/월
```

## 모니터링

### CloudWatch 메트릭 확인

-   **CPUUtilization**: CPU 사용률 (80% 이상 시 업그레이드 고려)
-   **MemoryUtilization**: 메모리 사용률 (85% 이상 시 업그레이드 고려)
-   **NetworkIn/NetworkOut**: 네트워크 사용량
-   **CPUCreditBalance**: t3 시리즈의 CPU 크레딧 잔액

### 알람 설정

-   CPU 사용률 > 80% 지속 시 알람
-   메모리 사용률 > 85% 지속 시 알람
-   CPU 크레딧 잔액 < 100 (t3 시리즈)

## 현재 프로젝트 추천

### 권장 구성

```
인스턴스 타입: t3.xlarge
vCPU: 4
메모리: 16GB
스토리지: 50GB gp3
예상 비용: ~$120/월

이유:
- 동시 3-5개 브라우저 실행 가능
- 메모리 여유 확보
- 비용 대비 성능 우수
- 프로덕션 환경에 적합
```

### 시작 구성 (비용 절감)

```
인스턴스 타입: t3.large
vCPU: 2
메모리: 8GB
스토리지: 30GB gp3
예상 비용: ~$60/월

이유:
- 동시 2-3개 브라우저 실행 가능
- 개발/테스트에 충분
- 비용 효율적
- 필요 시 쉽게 업그레이드 가능
```

## 참고사항

-   **리전**: ap-northeast-2 (서울) 사용 시 가장 낮은 지연시간
-   **AMI**: Ubuntu 22.04 LTS 권장
-   **보안 그룹**: SSH(22), HTTP(80), HTTPS(443) 포트 개방
-   **Elastic IP**: 고정 IP 주소 필요 시 할당

## 업그레이드 경로

1. **t3.medium** → **t3.large**: 메모리 부족 시
2. **t3.large** → **t3.xlarge**: 동시 실행 수 증가 시
3. **t3.xlarge** → **m5.2xlarge**: 일관된 성능 필요 시

## 참고 자료

-   [AWS EC2 인스턴스 타입](https://aws.amazon.com/ec2/instance-types/)
-   [AWS 가격 계산기](https://calculator.aws/)
-   [Playwright 시스템 요구사항](https://playwright.dev/docs/intro#system-requirements)
